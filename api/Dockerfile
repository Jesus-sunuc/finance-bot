FROM almalinux:9

RUN dnf -y install \
      python3.11 \
      python3.11-pip \
      python3.11-devel \
      gcc && \
    pip3.11 install --upgrade pip && \
    dnf clean all && \
    rm -rf /var/cache/yum

WORKDIR /app

COPY ./requirements.txt requirements.txt
RUN pip install --no-cache-dir --upgrade -r requirements.txt

RUN dnf -y remove gcc python3.11-devel && \
    dnf clean all && \
    rm -rf /var/cache/yum

COPY ./src src

CMD ["fastapi", "run", "src/main.py", "--proxy-headers", "--host", "0.0.0.0", "--port", "8080"]


